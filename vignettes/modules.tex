%\VignetteIndexEntry{modules}
\documentclass{article}

%%% latex packages
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[usenames,dvipsnames]{xcolor}

\usepackage{lipsum} % for dummy text only

%% change margins to 1" all the way around
\oddsidemargin 0.0in
\evensidemargin 0.0in
\textwidth 6.5in
\headheight 0.0in
\topmargin 0.0in
\textheight 9.0in

%%% document info
\title{Building modules in \texttt{SpaDES}}

\author{
  Alex M. Chubaty\\
  \small{Natural Resources Canada, Pacific Forestry Centre}\\
  \small{email: \href{mailto:achubaty@nrcan.gc.ca}{achubaty@nrcan.gc.ca}}
  \and
  Eliot McIntire\\
	\small{Natural Resources Canada, Pacific Forestry Centre}\\
	\small{email: \href{mailto:emcintir@nrcan.gc.ca}{emcintir@nrcan.gc.ca}}
}

\usepackage{Sweave}
\begin{document}
\input{modules-concordance}
 % displays code as entered (no arranging lines)

\maketitle

\tableofcontents

\newpage

\section{Introduction}

\subsection{Module overview} %% this subsection copied wholesale from intro vignette

\paragraph{}
\texttt{SpaDES} modules are event-based, meaning that different actions (calculations) are performed on data objects based on the order of scheduled events. Basically, a module consists of a collection of events which are scehduled depending on the rules of your simulation. Each event may evaluate or modify a simulation data object.

\subsection{Events}

\paragraph{Simulation event list}
Lorem ipsum ...

\paragraph{Module events}
Lorem ipsum ...

\paragraph{Module event dependencies}
Typically, each module schedules its own events (e.g., a "fire" module may schedule "burn" events) and only uses its own data objects. Modules that behave in this way are indepedent of each other, and this is generally the prefered way to design and implement modules. A module that schedules events from another module is said to depend on that module. Module event dependencies compilcate the construction of simulation models, and hinder the ability to develop and deploy models with modularity. If two modules are actually depedent on each others' events, then you should consider whether they really are separate modules or should be merged into a single module.

\subsection{Objects}

\paragraph{}
As you build your module / simulation, you can use any of \textsf{R}'s data types to store your objects / data. In particular, matrices (including vectors) and lists work well for this purpose because they are pass-by-reference, which reduces your model's memory footprint and speeds up your codes execution. Other useful datatypes include Raster* and SpatialPoints* objects.

\paragraph{Global objects}
Use \texttt{<<-} to assign global objects to reduce copying large objects (such as maps), which slows model execution.

\paragraph{Module object dependencies}
As noted above, modules can depend on one another for event scheduling. Modules can also be design to rely on outputs (data objects) from other modules. A module that relies on a global simulation data object that previously used by another module is said to be dependent on that other module. It is often useful to develop collections of modules that interact indirectly and are dependent in this way. Note that modules need not be inter-dependent on one another: module B may depend on module A (for example to initialize a data object), without module A depending on module B.

\newpage

\section{Creating a new module}

\subsection{Module design considerations}

\paragraph{}
\textit{\color{blue}{perhaps a bit about design phlosophy, relating back to dependencies and how to carefully build modules that actually retain modularity.}}

\subsection{Using the module template}

\paragraph{}
...

\newpage

\section{A simple landscape module}

\subsection{Modelling forest succession}

\paragraph{}
...

\newpage

\section{A simple spread module}

\subsection{Modelling fire spread}

\paragraph{}
...

\newpage

\section{A simple agent module}

\subsection{Modelling caribou movement}

\paragraph{}
...

\end{document}
